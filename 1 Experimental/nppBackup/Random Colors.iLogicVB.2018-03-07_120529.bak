Private Sub Main
    UpdateAssyBrowser(ThisDoc.Document)
End Sub

  Private Sub UpdateAssyBrowser(ByVal oDoc As Inventor.Document)
    Dim oAssy As Inventor.AssemblyDocument
    Dim oComp As Inventor.ComponentOccurrence
    Dim oSubDoc As Inventor.Document

    Dim NodeName() As String
    Dim InstNum As String
	
	Randomize()
	
    If oDoc.DocumentType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject Then
      oAssy = CType(oDoc, AssemblyDocument)
	  
	Dim RS as Render Style
	
	For Each oComp In oAssy.ComponentDefinition.Occurrences
        oSubDoc = CType(oComp.Definition.Document, Document)
		'If Left(oComp.Name,7) = "PlyWood" Then
			'If oSubDoc.DocumentType = Inventor.DocumentTypeEnum.kPartDocumentObject Then
				'MessageBox.show("Matching Part file found!")
				
				
				Dim Red as Byte = CByte((255 * Rnd()))
				Dim Green As Byte = CByte((255 * Rnd()))
				Dim Blue As Byte = CByte((255 * Rnd()))
				
				
				
				Component.Color(oComp.Name) = oColor
				
				oComp.appearance = color
			'End If
		'End If
        'If oSubDoc.DocumentType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject Then
        '  Call UpdateAssyBrowser(oSubDoc)
        'End If

      Next oComp
    End If
  End Sub
  
  Public Sub CreateSimpleColorAppearance()
    Dim doc As Document
    Set doc = ThisApplication.ActiveDocument
    
    ' Only document appearances can be edited, so that's what's created.
    ' This assumes a part or assembly document is active.
    Dim docAssets As Assets
    Set docAssets = doc.Assets
    
    ' Create a new appearance asset.
    Dim appearance As Asset
    Set appearance = docAssets.Add(kAssetTypeAppearance, "Generic", _
                                    "MyShinyRed", "My Shiny Red Color")
    
    Dim tobjs As TransientObjects
    Set tobjs = ThisApplication.TransientObjects


    Dim color As ColorAssetValue
    Set color = appearance.Item("generic_diffuse")
    color.value = tobjs.CreateColor(255, 15, 15)
    
    Dim floatValue As FloatAssetValue
    Set floatValue = appearance.Item("generic_reflectivity_at_0deg")
    floatValue.value = 0.5
    
    Set floatValue = appearance.Item("generic_reflectivity_at_90deg")
    floatValue.value = 0.5
End Sub
