Private Sub Main
    UpdateAssyBrowser(ThisDoc.Document)
End Sub

  Private Sub UpdateAssyBrowser(ByVal oDoc As Inventor.Document)
    Dim oAssy As Inventor.AssemblyDocument
    Dim oComp As Inventor.ComponentOccurrence
    Dim oSubDoc As Inventor.Document

    Dim NodeName() As String
    Dim InstNum As String
	
	Randomize()
	
    If oDoc.DocumentType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject Then
      oAssy = CType(oDoc, AssemblyDocument)
	  
	Dim RS as Render Style
	
	For Each oComp In oAssy.ComponentDefinition.Occurrences
        oSubDoc = CType(oComp.Definition.Document, Document)
		'If Left(oComp.Name,7) = "PlyWood" Then
			'If oSubDoc.DocumentType = Inventor.DocumentTypeEnum.kPartDocumentObject Then
				'MessageBox.show("Matching Part file found!")
				
				
				Dim Red as Byte = CByte((255 * Rnd()))
				Dim Green As Byte = CByte((255 * Rnd()))
				Dim Blue As Byte = CByte((255 * Rnd()))
				
				
				
				Component.Color(oComp.Name) = oColor
				
				oComp.appearance = color
			'End If
		'End If
        'If oSubDoc.DocumentType = Inventor.DocumentTypeEnum.kAssemblyDocumentObject Then
        '  Call UpdateAssyBrowser(oSubDoc)
        'End If

      Next oComp
    End If
  End Sub