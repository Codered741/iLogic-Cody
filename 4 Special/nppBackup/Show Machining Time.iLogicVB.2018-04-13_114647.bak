pMilledFaceCount.Value = 0
pPerim.Value = 0

'Get Machined Sides
pMilledFaceCount.Value = InputBox("Please enter the number of Machined Sides (1-6)", "Mill OP Detected", "0")

MsgBox("Please select the bottom router face.  ", Title := "Router OP detected")
pPerim.Value = GetPerimeter(oDoc)

Dim MillingTime As Double
Dim DrillTime As Double
Dim TapTime As Double
Dim FlipTime As Double
Dim RoutingTime As Double
Dim SetupTime As Double
Dim ProgramTime As Double
Dim ComplexMult As Double
Dim MillPerPart As Double
Dim MillSetup As Double

ComplexMult = ComplexityModifier(pEdges.Value)

'Estimate Time to remove material, defaults to steel value unless aluminum is detected.  
If pMaterial.Value.Contains("Aluminum") AndAlso pMilledFaceCount.Value > 0 Then
	MillingTime	= (pMtlRem.Value / 0.3616)*ComplexMult
Else 'If pMaterial.Value.Contains("Steel") 
	MillingTime = (pMtlRem.Value / 0.1448)*ComplexMult
End If

If pPerim.Value > 0 Then 
	RoutingTime = Round(pPerim.Value / 100, 2) 'Check this Value
End If

DrillTime = pHoles.Value * 30
TapTime = pHolesTap.Value * 30
FlipTime = pMilledFaceCount.Value * 30

SetupTime = pMilledFaceCount.Value * 1800
ProgramTime = ComplexMult * 600

'MsgBox("Routing Time: " & RoutingTime & " min")

If pMilledFaceCount.Value > 0 Then
	MillPerPart = Round((MillingTime + DrillTime + TapTime + FlipTime)/60, 2)
Else 
	MillPerPart = 0
End If

MillSetup = (SetupTime + ProgramTime)/60

MsgBox("Milling Time (per Part): " & MillPerPart & " min" & vbCrLf & _
	"Mill Setup (one time): " & MillSetup & " min" & vbCrLf & _
	"Routing Time: " & RoutingTime & " min")
			
'MsgBox("Mill Setup (one time): " & MillSetup & " min")